!function(){let n,t,s=Date.now(),e=0,i=!1,o=0,a=0,r=new Set,c=0,l=0,p=null,d=!1;function f(){if("complete"!==document.readyState)return void setTimeout(f,300);const n=()=>{const t=document.querySelector(".main-nowPlayingBar-extraControls");if(!t)return void setTimeout(n,300);const s=document.createElement("div");s.id="sesh-stats-container",s.style.display="inline-flex",s.style.alignItems="center";const e=document.createElement("button");e.className="sesh-stats-button Button-sc-1dqy6lx-0 Button-buttonTertiary-small-iconOnly-useBrowserDefaultFocusStyle e-9800-overflow-wrap-anywhere e-9800-button-tertiary--icon-only",e.onclick=m,e.setAttribute("aria-label","Session Stats");const i=x(b());e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16"><path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock" viewBox="0 0 16 16"><path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"/></svg> <span id="sesh-stats-time-display">${i}</span>`,e.title=`Session Stats: Play Time ${i} - Click for details`,s.appendChild(e),t.insertBefore(s,t.firstChild),setInterval((()=>{const n=x(b()),t=e.querySelector("#sesh-stats-time-display");t&&(t.textContent=n),e.title=`Session Stats: Play Time ${n} - Click for details`}),1e3)};n()}function u(){if(!n)return;const t=Date.now()-s;n.innerHTML=`\n      <h3>\n        <span>Session Stats</span>\n        <button id="sesh-stats-close" aria-label="Close">Ã—</button>\n      </h3>\n      <div class="stat-row">\n        <span>Session Duration:</span>\n        <span>${x(t)}</span>\n      </div>\n      <div class="stat-row">\n        <span>Playback Time:</span>\n        <span>${x(b())}</span>\n      </div>\n      <div class="stat-row">\n        <span>Songs Started:</span> \n        <span>${c}</span> \n      </div>\n      <div class="stat-row">\n        <span>Songs Completed/Skipped:</span>\n        <span>${l}</span>\n      </div>\n      <div class="stat-row">\n        <span>Unique Tracks Played:</span>\n        <span>${r.size}</span>\n      </div>\n    `;const e=n.querySelector("#sesh-stats-close");e&&e.addEventListener("click",y)}function m(){d?y():function(){u();const t=document.querySelector("#sesh-stats-container");if(t){const n=t.getBoundingClientRect(),s=document.getElementById("sesh-stats-overlay");if(s){const t=300;let e=n.left+n.width/2-t/2;const i=window.innerWidth-t-10;e>i&&(e=i),e<10&&(e=10),s.style.left=`${e}px`}}n.classList.add("visible"),d=!0}()}function y(){n.classList.remove("visible"),d=!1}function h(){a++;let n=null;if(Spicetify.Player.data?.track?.uri)n=Spicetify.Player.data.track.uri;else if(Spicetify.Player.data?.item?.uri)n=Spicetify.Player.data.item.uri;else if("function"==typeof Spicetify.Player.getTrack){const t=Spicetify.Player.getTrack();t?.uri&&(n=t.uri)}else if(Spicetify.Platform?.PlayerAPI?.getState?.()){const t=Spicetify.Platform.PlayerAPI.getState();t?.item?.uri&&(n=t.item.uri)}n&&(c=a,p&&p!==n&&l++,p=n,r.add(n),d&&u())}function b(){let n=e;try{i&&Spicetify.Player.isPlaying()&&(n+=Date.now()-o)}catch(n){}return n}function v(){d&&u()}function x(n){const t=Math.floor(n/1e3%60),s=Math.floor(n/6e4%60);return`${Math.floor(n/36e5).toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}!async function(){for(;!Spicetify||!Spicetify.Player||!Spicetify.Platform;)await new Promise((n=>setTimeout(n,100)));!function(){const n=document.createElement("style");n.textContent="\n      /* Overlay styles */\n      #sesh-stats-overlay {\n        position: fixed;\n        bottom: 52px; /* Position above the button */\n        /* Position will be set by JavaScript */\n        background-color: var(--spice-card);\n        border-radius: 8px;\n        padding: 16px;\n        color: var(--spice-text);\n        font-size: 14px;\n        z-index: 1000;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\n        display: none;\n        width: 300px;\n        max-width: 90vw;\n        transition: transform 0.2s ease, opacity 0.2s ease; /* Smooth transition */\n        transform-origin: bottom center;\n      }\n      \n      #sesh-stats-overlay.visible {\n        display: block;\n        animation: slideUp 0.2s ease;\n      }\n      \n      @keyframes slideUp {\n        from { opacity: 0; transform: translateY(10px) scale(0.95); }\n        to { opacity: 1; transform: translateY(0) scale(1); }\n      }\n      \n      #sesh-stats-overlay h3 {\n        margin: 0 0 12px 0;\n        font-size: 16px;\n        font-weight: 700;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      \n      #sesh-stats-close {\n        background: none;\n        border: none;\n        color: var(--spice-text);\n        cursor: pointer;\n        padding: 4px 8px;\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 16px;\n        transition: background-color 0.2s ease;\n      }\n      \n      #sesh-stats-close:hover {\n        background-color: var(--spice-button);\n      }\n      \n      #sesh-stats-overlay .stat-row {\n        display: flex;\n        justify-content: space-between;\n        margin: 8px 0;\n        padding-bottom: 8px;\n        border-bottom: 1px solid var(--spice-button-disabled);\n      }\n      \n      #sesh-stats-overlay .stat-row:last-of-type {\n        border-bottom: none;\n      }\n      \n      .sesh-stats-button {\n        background: none !important;\n        border: none !important;\n        color: var(--spice-text) !important;\n        cursor: pointer !important;\n        font-size: 12px !important;\n        font-weight: 400 !important;\n        opacity: 0.7 !important;\n        padding: 0 8px !important;\n        transition: opacity 0.2s ease !important;\n        height: 32px !important;\n        display: flex !important;\n        align-items: center !important;\n      }\n      \n      .sesh-stats-button svg {\n        width: 14px;\n        height: 14px;\n        margin-right: 4px;\n        fill: currentColor;\n        vertical-align: text-bottom; /* Align icons with text */\n      }\n      \n      /* Fixed-width font for the timer to prevent shifting */\n      #sesh-stats-time-display {\n        font-family: 'Courier New', monospace;\n        display: inline-block;\n        min-width: 80px; /* Set a fixed minimum width */\n        text-align: left;\n        font-size: 14px; /* Slightly larger text */\n        font-weight: bold; /* Make it bold */\n      }\n      \n      .sesh-stats-button:hover {\n        opacity: 1 !important;\n      }\n    ",document.head.appendChild(n)}(),f(),n=document.createElement("div"),n.id="sesh-stats-overlay",u(),document.body.appendChild(n),document.addEventListener("click",(t=>{!d||n.contains(t.target)||t.target.closest("#sesh-stats-container")||y()})),document.addEventListener("keydown",(n=>{"Escape"===n.key&&d&&y()})),Spicetify.Player.addEventListener("onplaypause",(()=>{Spicetify.Player.isPlaying()?i||(i=!0,o=Date.now()):i&&(i=!1,e+=Date.now()-o)})),Spicetify.Player.addEventListener("songchange",h),t=setInterval(v,1e3)}()}();