(()=>{let e=null,t=null;const n="focus-mode-active",i="focus-mode-controls-visible",o="focus-mode-",r=`${o}album-art`,l=`${o}player-controls`,a=`${o}track-info`,c=`${o}react-root`,s={background:"rgba(255, 255, 255, 0.1)",color:"white",border:"none",borderRadius:"50%",padding:"8px",minWidth:"32px",minHeight:"32px",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},u="body .Root__top-bar, body .Root__nav-bar, body .Root__main-view, body .Root__now-playing-bar, body .Root__right-sidebar",y=".main-nowPlayingView-section, .main-trackInfo-container, .main-trackList-trackList";let d=!1,p=null,m=null,f=!1,h=null,v=null,g=null,b=!1,w=!1,S=!1,k=null,x=null,E=null,P=null,L=null,C=null;function $(){const e=Spicetify.Player.data?.item;if(!e)return p=null,m=null,void(w=!1);const t=e.metadata;if(t){Spicetify.Platform&&Spicetify.Platform.PlayerAPI,p=t;const e=t?.image_xlarge_url||t?.image_large_url||t?.image_url;m=e||null,async function(){try{if(!Spicetify.Platform||!Spicetify.Platform.PlayerAPI)return!1;const e=Spicetify.Player.data?.item;if(!e||!e.uri)return!1;if(Spicetify.Player.getLyrics)try{const e=await Spicetify.Player.getLyrics();if(e&&e.lines&&e.lines.length>0)return!0}catch(e){}if(Spicetify.Platform.PlayerAPI.getPlayerState)try{const e=await Spicetify.Platform.PlayerAPI.getPlayerState();if(e?.track?.hasLyrics||e?.track?.lyrics)return!0}catch(e){}if("true"===p?.has_lyrics||"true"===p?.lyrics||p?.lyrics_id)return!0}catch(e){return!1}return!1}().then((e=>{w=e,T()})).catch((e=>{w=!1,T()}))}else p={uri:e.uri},m=null,w=!1}const I=({icon:t,onClick:n,className:i="",style:o={}})=>{const r=Spicetify.SVGIcons[t];return r?e.createElement("button",{className:`focus-mode-control-button ${i}`,onClick:n,style:{...s,...o}},r?e.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"currentColor",dangerouslySetInnerHTML:{__html:r}}):e.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"rgba(255, 255, 255, 0.5)"},e.createElement("path",{d:"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8z"}))):null},_=()=>{const[t,n]=e.useState(Spicetify.Player.isPlaying()),[i,o]=e.useState(Spicetify.Player.getVolume()),[l,a]=e.useState(i),[c,s]=e.useState(.25);e.useEffect((()=>(P=o,L=a,C=s,()=>{P=null,L=null,C=null})),[]),e.useEffect((()=>{const e=({data:e})=>{o(e),a(e)};Spicetify.Player.addEventListener("onvolumechange",e);const t=Spicetify.Player.getVolume();return o(t),a(t),()=>{Spicetify.Player.removeEventListener("onvolumechange",e)}}),[]),e.useEffect((()=>{const e=()=>n(Spicetify.Player.isPlaying());return Spicetify.Player.addEventListener("onplaypause",e),e(),()=>{Spicetify.Player.removeEventListener("onplaypause",e)}}),[]),e.useEffect((()=>{const e=document.getElementById(r);e&&(e.style.opacity=c)}),[]);return e.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"15px",width:"100%",padding:"0 20px"}},e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"5px",flexBasis:"150px"}},e.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"currentColor",dangerouslySetInnerHTML:{__html:Spicetify.SVGIcons.brightness||Spicetify.SVGIcons.search}}),e.createElement("input",{type:"range",min:0,max:1,step:.01,value:c,onChange:e=>{const t=parseFloat(e.target.value);s(t);const n=document.getElementById(r);n&&(n.style.opacity=t)},style:{flexGrow:1,cursor:"pointer"}})),e.createElement(I,{icon:"skip-back",onClick:Spicetify.Player.back}),e.createElement(I,{icon:t?"pause":"play",onClick:Spicetify.Player.togglePlay,style:{transform:"scale(1.1)"}}),e.createElement(I,{icon:"skip-forward",onClick:Spicetify.Player.next}),e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"5px",flexBasis:"150px"}},e.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"currentColor",dangerouslySetInnerHTML:{__html:i>.5?Spicetify.SVGIcons.volume:i>0?Spicetify.SVGIcons["volume-low"]:Spicetify.SVGIcons["volume-off"]}}),e.createElement("input",{type:"range",min:0,max:1,step:.01,value:l,onChange:e=>{const t=parseFloat(e.target.value);a(t),Spicetify.Player.setVolume(t)},style:{flexGrow:1,cursor:"pointer"}})))};function A(e){}function B(e){}const M=({trackData:t,albumArtUrl:n,controlsVisible:i})=>{const c=(s=n)&&s.startsWith("spotify:image:")?`https://i.scdn.co/image/${s.substring(14)}`:null;var s;const u=t?.title||"Loading...",y=t?.artist_name||"",d=t?.album_title||"";return e.createElement("div",{id:o+"content"},c&&e.createElement("img",{id:r,src:c,alt:"Album Art"}),e.createElement("div",{id:"fad-lyrics-plus-container",className:"lyrics-overlay-container"}),e.createElement("div",{id:a},e.createElement("div",{className:"track-title"},u),e.createElement("div",{className:"track-artist"},y),d&&e.createElement("div",{className:"track-album"},d)),e.createElement("div",{id:l},e.createElement(_,null)))};function T(){d&&g&&t.render(e.createElement(M,{trackData:p,albumArtUrl:m,controlsVisible:f}),g)}function V(){d&&(f||(f=!0,document.body.classList.add(i)),h&&clearTimeout(h),h=setTimeout((()=>{f=!1,document.body.classList.remove(i),h=null}),3e3))}function H(e){if(d&&d)switch(e.key.toLowerCase()){case"escape":F();break;case" ":Spicetify.Player.togglePlay(),e.preventDefault();break;case"arrowleft":Spicetify.Player.back(),e.preventDefault();break;case"arrowright":Spicetify.Player.next(),e.preventDefault();break;case"arrowup":const t=Spicetify.Player.getVolume(),n=Math.min(1,t+.05);Spicetify.Player.setVolume(n),P&&L&&(P(n),L(n)),e.preventDefault();break;case"arrowdown":const i=Spicetify.Player.getVolume(),o=Math.max(0,i-.05);Spicetify.Player.setVolume(o),P&&L&&(P(o),L(o)),e.preventDefault();break;case"+":case"=":R(.05),e.preventDefault();break;case"-":R(-.05),e.preventDefault();break;case"l":!async function(){w?(S=!S,S?(E=Spicetify.Platform.History.location.pathname,"/lyrics-plus"!==E&&Spicetify.Platform.History.push("/lyrics-plus"),setTimeout((()=>{window.addEventListener("lyrics-plus-update",A),window.dispatchEvent(new Event("fad-request")),document.body.classList.add("focus-mode-lyrics-active"),k=null,x=-1,T()}),200)):(window.removeEventListener("lyrics-plus-update",A),E&&"/lyrics-plus"!==E&&Spicetify.Platform.History.push(E),E=null,document.body.classList.remove("focus-mode-lyrics-active"),k=null,x=-1,Spicetify.Player.removeEventListener("onprogress",B),T())):Spicetify.showNotification("Lyrics not available for this track.")}(),e.preventDefault()}}function R(e){const t=document.getElementById(r);if(t){const n=parseFloat(t.style.opacity||.25),i=Math.max(0,Math.min(1,n+e));t.style.opacity=i,C&&C(i)}}function D(e){!d||e.target.closest(`#${l}`)||e.target.closest(`#${a}`)||!v||v.element.contains(e.target)||F()}function z(){setTimeout((()=>{$(),d&&T()}),100)}async function j(){if(d)return;if(b=!!document.fullscreenElement,!b&&document.documentElement.requestFullscreen)try{await document.documentElement.requestFullscreen()}catch(e){}const e="focus-mode-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.textContent=`\n    /* Hide original UI when focus mode active */\n    body.${n} ${u} {\n      opacity: 0 !important;\n      visibility: hidden !important;\n      pointer-events: none !important;\n      transition: opacity 500ms ease, visibility 500ms ease;\n    }\n    body.${n} ${y} {\n      display: none !important;\n    }\n    body.${n} { \n      overflow: hidden !important; \n      /* Cursor hidden globally removed */\n    }\n\n    /* Focus Mode Root Container - Initially hidden */\n    #${c} {\n      display: none; /* Hidden by default */\n      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;\n      z-index: 9998; \n      background-color: #000; \n      pointer-events: none; /* Initially no pointer events */\n      cursor: none; /* Hide cursor only on the background element */\n    }\n\n    /* Show and enable root container only when active */\n    body.${n} #${c} {\n        display: block;\n        pointer-events: auto; /* Enable clicks on background */\n    }\n\n    /* Album Art Styling (within React component) */\n    #${r} {\n      display: block;\n      position: absolute;\n      top: 0; left: 0;\n      width: 100%; height: 100%;\n      object-fit: contain; \n      margin: 0; padding: 0; border: none;\n    }\n\n    /* Controls Container Styling (within React component) */\n    #${l} {\n      position: absolute; \n      bottom: 0; left: 0;\n      width: 100%;\n      z-index: 10000; \n      background: rgba(0, 0, 0, 0.7); \n      padding: 16px 0; \n      pointer-events: auto; \n      opacity: 0; \n      transition: opacity 500ms ease !important;\n      display: flex; \n      justify-content: center;\n      cursor: auto !important;\n    }\n    body.${n}.${i} #${l} {\n      opacity: 1 !important;\n    }\n\n    /* Track Info Container Styling (within React component) */\n    #${a} {\n      position: absolute; \n      top: 0; left: 0;\n      width: 100%;\n      text-align: center; \n      z-index: 10000; \n      pointer-events: none; /* Let mouse events pass through by default */\n      opacity: 0; \n      transition: opacity 500ms ease !important;\n      background: rgba(0, 0, 0, 0.7); \n      padding: 16px; \n      color: white; \n      cursor: none; /* Hide cursor by default on this layer */\n    }\n    /* Allow pointer events on the icon when it's shown */\n    #${a} .track-title span[title="Toggle Lyrics (L)"] {\n      pointer-events: auto;\n      /* Ensure the SVG icon inherits text color */\n      fill: currentColor;\n      width: 1em;\n      height: 1em;\n      display: inline-block; /* Explicitly set display */\n      cursor: pointer; /* Show pointer specifically on the icon */\n    }\n    body.${n}.${i} #${a} {\n      opacity: 1 !important;\n      cursor: auto !important; /* Show cursor when overlay is visible */\n    }\n    #${a} .track-title {\n      font-size: 1.2em; font-weight: bold;\n    }\n    #${a} .track-artist {\n      font-size: 1em; opacity: 0.8;\n    }\n    #${a} .track-album {\n      font-size: 0.9em; opacity: 0.7; font-style: italic;\n    }\n    \n    /* Ensure cloned controls inherit necessary styles */\n    #${l} .main-nowPlayingBar-center {\n        /* Add specific overrides if needed */\n    }\n    \n    /* --- Lyrics Overlay Styles --- */\n    #fad-lyrics-plus-container.lyrics-overlay-container {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      z-index: 9999; /* Above art (9998), below controls/info (10000) */\n      background: rgba(0, 0, 0, 0.7); /* Semi-transparent background */\n      overflow-y: auto; /* Allow scrolling if lyrics-plus content overflows */\n      pointer-events: none; /* Allow clicks through to bg/art by default */\n      opacity: 0; /* Hidden by default */\n      transition: opacity 500ms ease;\n      \n      /* Assume lyrics-plus provides its own text styling (color, size, alignment) */\n      /* We only provide the container */\n    }\n    \n    /* Enable pointer events if lyrics-plus content needs interaction */\n    /* This might need adjustment depending on lyrics-plus behavior */\n    #fad-lyrics-plus-container.lyrics-overlay-container > * {\n      pointer-events: auto; \n    }\n    \n    /* Show the overlay when lyrics are active */\n    body.focus-mode-lyrics-active #fad-lyrics-plus-container.lyrics-overlay-container {\n      opacity: 1;\n    }\n    \n    /* Ensure Track Info and Player Controls are definitely above the lyrics */\n    #${a} { z-index: 10000; }\n    #${l} { z-index: 10000; }\n    \n    /* Hide lyrics-plus config button container when lyrics overlay is active */\n    body.focus-mode-lyrics-active #fad-lyrics-plus-container .lyrics-config-button-container {\n      display: none !important; /* Hide the element */\n    }\n    \n  `,document.head.appendChild(t)}d=!0,v&&(v.active=!0),document.body.classList.add(n),$(),g||(g=document.createElement("div"),g.id=c,document.body.appendChild(g)),f=!1,document.body.classList.remove(i),T(),document.addEventListener("mousemove",V),document.addEventListener("keydown",H),document.addEventListener("click",D),V()}function F(){if(!d)return f=!1,void(v&&(v.active=!1));if(!b&&document.fullscreenElement&&document.exitFullscreen)try{document.exitFullscreen()}catch(e){}document.removeEventListener("mousemove",V),document.removeEventListener("keydown",H),document.removeEventListener("click",D),h&&(clearTimeout(h),h=null),g&&t.unmountComponentAtNode(g),document.body.classList.remove(n),document.body.classList.remove(i);try{document.querySelectorAll(u).forEach((e=>{e instanceof HTMLElement&&(e.style.opacity="1",e.style.visibility="visible",e.style.pointerEvents="auto",e.style.display="")}))}catch(e){}d=!1,f=!1,v&&(v.active=!1),g&&(g.remove(),g=null);const e=document.getElementById("focus-mode-styles");e&&e.remove(),p=null,m=null}!function n(){for(;!(Spicetify?.React&&Spicetify?.ReactDOM&&Spicetify?.Player?.addEventListener&&Spicetify?.Playbar?.Button&&Spicetify?.showNotification);)return setTimeout(n,100);e=Spicetify.React,t=Spicetify.ReactDOM,F(),p=null,m=null,function(){if(!Spicetify?.Playbar?.Button)return;v=new Spicetify.Playbar.Button("Focus Mode",'\n    <span class="e-9800-button__icon-wrapper" aria-hidden="true">\n      <svg \n        role="img"\n        height="16"\n        width="16"\n        aria-hidden="true"\n        viewBox="0 0 128 128" \n        fill="currentColor"\n        class="e-9800-icon e-9800-baseline"\n      >\n        \n    \x3c!-- Background circle (optional, might be handled by button style) --\x3e\n    \x3c!-- <circle cx="64" cy="64" r="60" fill="#1DB954"/> --\x3e\n    \n    \x3c!-- Album art frame --\x3e\n    <rect x="32" y="32" width="64" height="64" rx="4" fill="none" stroke="currentColor" stroke-width="2"/>\n    \n    \x3c!-- Corner arrows --\x3e\n    \x3c!-- Top-left --\x3e\n    <path d="M32 48 L32 32 L48 32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    \n    \x3c!-- Top-right --\x3e\n    <path d="M96 48 L96 32 L80 32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    \n    \x3c!-- Bottom-left --\x3e\n    <path d="M32 80 L32 96 L48 96" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    \n    \x3c!-- Bottom-right --\x3e\n    <path d="M96 80 L96 96 L80 96" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    \n    \x3c!-- Center focus dot --\x3e\n    <circle cx="64" cy="64" r="12" fill="currentColor"/>\n  \n      </svg>\n    </span>\n  ',(e=>{d?F():j()}),!1);try{v.register()}catch(e){}}(),Spicetify.Player.addEventListener("songchange",z),setTimeout(z,500)}()})();